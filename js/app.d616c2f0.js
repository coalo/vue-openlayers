(function(t){function e(e){for(var o,l,a=e[0],r=e[1],c=e[2],f=0,p=[];f<a.length;f++)l=a[f],s[l]&&p.push(s[l][0]),s[l]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);d&&d(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],o=!0,a=1;a<i.length;a++){var r=i[a];0!==s[r]&&(o=!1)}o&&(n.splice(e--,1),t=l(l.s=i[0]))}return t}var o={},s={app:0},n=[];function l(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,l),i.l=!0,i.exports}l.m=t,l.c=o,l.d=function(t,e,i){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(l.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)l.d(i,o,function(e){return t[e]}.bind(null,o));return i},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/vue-openlayers/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],r=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var d=r;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"257d":function(t,e,i){"use strict";var o=i("e42e"),s=i.n(o);s.a},"303b":function(t,e,i){"use strict";var o=i("c02c"),s=i.n(o);s.a},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var o=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("HelloWorld",{attrs:{msg:"Welcome to Your Vue.js App"}})],1)},n=[],l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"map"},[i("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"map-left"},[i("div",{staticClass:"top"},[i("div",{staticClass:"title"},[t._v("区域列表")]),i("el-button",{staticClass:"style-setting",attrs:{type:"text",icon:"icon-color"},on:{click:t.handleSetStyle}},[t._v("\n        样式设置\n      ")])],1),t.polygons.length?i("div",{staticClass:"list"},[i("el-checkbox",{staticStyle:{"margin-bottom":"10px"},attrs:{indeterminate:!(t.checkList.length===t.polygons.length||!t.checkList.length),value:t.checkList.length===t.polygons.length},on:{change:t.handleCheckAllChange}},[t._v("全选")]),i("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.polygons,function(e,o){return i("div",{key:e.id,staticClass:"list-item"},[i("el-checkbox",{attrs:{label:e.id}},[t._v("\n            "+t._s("")+"\n          ")]),i("div",{staticClass:"item",on:{click:function(i){return t.handleListItemClick(e,o)}}},[i("span",{staticClass:"item-color",style:{"border-color":t.hexToRgba(e.styles.strokeColor,e.styles.strokeOpacity),"border-width":e.styles.strokeWeight+"px","background-color":t.hexToRgba(e.styles.fillColor,e.styles.fillOpacity)}}),i("span",{staticClass:"item-name"},[t._v(t._s(e.title))])])],1)}),0)],1):t._e(),i("style-setting",{ref:"styleSetting",attrs:{styles:this.styles.polygon,polygons:t.polygons},on:{confirm:t.styleSettingConfirm}})],1),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"map-content"},[i("div",{attrs:{id:"GDMap"}}),i("el-card",{staticClass:"map-tools",attrs:{"body-style":{padding:"5px"}}},[t._l(t.mapTools,function(e,o){return[i("el-tooltip",{key:o,attrs:{content:e.label,effect:"dark",placement:"bottom"}},[i("i",{class:["tool-icon",e.icon],on:{click:function(i){return t.handleToolClick(e)}}})])]})],2),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showMapTooltip,expression:"showMapTooltip"}],ref:"mapTooltip",staticClass:"map-tooltip"},[t._v("\n      "+t._s(t.mapTooltipText)+"\n    ")]),i("transition",{attrs:{name:"el-fade-in-linear"}},[t.infoWindow.visible?i("info-window",{ref:"infoWindow",attrs:{title:t.infoWindow.extData.title,pos:t.infoWindow.position},on:{close:t.infoWindowClose}},[t.infoWindow.isEditAttribute?i("el-form",[i("el-form-item",{attrs:{label:"标题"}},[i("el-input",{attrs:{placeholder:"请输入标题"},model:{value:t.infoWindow.extData.title,callback:function(e){t.$set(t.infoWindow.extData,"title",e)},expression:"infoWindow.extData.title"}})],1),i("el-form-item",{attrs:{label:"描述"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入描述"},model:{value:t.infoWindow.extData.desc,callback:function(e){t.$set(t.infoWindow.extData,"desc",e)},expression:"infoWindow.extData.desc"}})],1)],1):[t._v("\n          "+t._s(t.infoWindow.extData.desc)+"\n        ")],i("div",{staticClass:"info-window-footer",attrs:{slot:"footer"},slot:"footer"},[i("span",{staticClass:"by"}),i("div",{staticClass:"tools"},[t._l(t.infoWindowTools,function(e,o){return[i("el-tooltip",{key:o,attrs:{effect:"dark",content:e.label,placement:"top"}},[i("i",{class:["footer-icon",e.icon],on:{click:function(i){return t.infoWindowToolClick(e)}}})])]})],2)])],2):t._e()],1),i("edit-style-dialog",{ref:"editStyleDialog",attrs:{id:t.editStyleDialog.polygonId,styles:t.editStyleDialog.styles},on:{confirm:t.editStyleConfirm}})],1)],1)},a=[],r=(i("8e6e"),i("456d"),i("20d6"),i("bd86")),c=(i("7f7f"),i("ac6a"),i("5bc0"),i("5eee")),d=i("a2c7"),f=i("4cdf"),p=i("0710"),y=i("8f3a"),u=i("0af5"),h=i("5bc3"),m=i("9a44"),g=i("c807"),v=i("b2fc"),w=i("ac29"),b=i("5831"),C=i("2ef1"),S=i("3e6b"),k=i("480c"),x=i("6c77"),O=i("ce2c"),D=i("83a6"),W=i("8682");i("6b54"),i("a481");function _(t){var e,i,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=/^#/.test(t)?t.slice(1):t;return n=/^[0-9a-f]{3}|[0-9a-f]{6}$/i.test(n)?n:"fffff",3===n.length&&(n=n.replace(/(\w)(\w)(\w)/gi,"$1$1$2$2$3$3")),e=n.slice(0,2),i=n.slice(2,4),o=n.slice(4,6),e=parseInt(e,16),i=parseInt(i,16),o=parseInt(o,16),"rgba(".concat(e,", ").concat(i,", ").concat(o,", ").concat(s,")")}function P(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(t()).concat(t(),"-").concat(t(),"-").concat(t(),"-").concat(t(),"-").concat(t()).concat(t()).concat(t())}var $=i("335a"),I=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"infoWindow",staticClass:"info-window",style:{width:t.width},attrs:{id:"info-window"}},[i("div",{staticClass:"top"},[i("span",{staticClass:"title"},[t._v(t._s(t.title))]),i("span",{staticClass:"close",on:{click:t.handleClose}},[t._v("x")])]),i("div",{staticClass:"content"},[t._t("default")],2),t._t("footer")],2)},E=[],T={props:{width:{type:String,default:"320px"},title:String,pos:Object,offset:{type:Object,default:function(){return{x:0,y:-10}}}},methods:{handleClose:function(){this.$emit("close")}},watch:{pos:{handler:function(t){var e=this;t&&t.x&&t.y&&this.$nextTick(function(){var i=e.$refs.infoWindow.clientHeight;e.$refs.infoWindow.style.left=t.x+e.offset.x+"px",e.$refs.infoWindow.style.top=t.y-i/2+e.offset.y+"px"})},immediate:!0}}},M=T,F=(i("689d"),i("2877")),j=Object(F["a"])(M,I,E,!1,null,"2e5ca0ae",null),G=j.exports,L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"style-setting",style:{left:t.left}},[i("div",{staticClass:"setting-top"},[i("el-button",{attrs:{type:"text"},on:{click:t.hide}},[i("i",{staticClass:"top-icon el-icon-caret-left"})]),i("i",{staticClass:"top-icon icon-color"}),i("span",{staticClass:"top-title"},[t._v("样式设置")])],1),i("div",{staticClass:"style-config"},[i("div",{staticClass:"config-item"},[i("div",{staticClass:"item-left"},[t._v("填充颜色")]),i("div",{staticClass:"item-right"},[i("el-color-picker",{model:{value:t.myStyles.fillColor,callback:function(e){t.$set(t.myStyles,"fillColor",e)},expression:"myStyles.fillColor"}})],1)]),i("div",{staticClass:"config-item"},[i("div",{staticClass:"item-left"},[t._v("填充透明度")]),i("div",{staticClass:"item-right"},[i("div",{staticClass:"set-opacity"},[i("el-input-number",{attrs:{"controls-position":"right",min:0,max:100},model:{value:t.myStyles.fillOpacity,callback:function(e){t.$set(t.myStyles,"fillOpacity",e)},expression:"myStyles.fillOpacity"}}),i("div",{staticClass:"percent-sign"},[t._v("%")])],1)])]),i("div",{staticClass:"config-item"},[i("div",{staticClass:"item-left"},[t._v("轮廓颜色")]),i("div",{staticClass:"item-right"},[i("el-color-picker",{model:{value:t.myStyles.strokeColor,callback:function(e){t.$set(t.myStyles,"strokeColor",e)},expression:"myStyles.strokeColor"}})],1)]),i("div",{staticClass:"config-item"},[i("div",{staticClass:"item-left"},[t._v("轮廓宽度")]),i("div",{staticClass:"item-right"},[i("el-input-number",{attrs:{"controls-position":"right",min:1,max:5},model:{value:t.myStyles.strokeWeight,callback:function(e){t.$set(t.myStyles,"strokeWeight",e)},expression:"myStyles.strokeWeight"}})],1)]),i("div",{staticClass:"config-item"},[i("div",{staticClass:"item-left"},[t._v("轮廓透明度")]),i("div",{staticClass:"item-right"},[i("div",{staticClass:"set-opacity"},[i("el-input-number",{attrs:{"controls-position":"right",min:0,max:100},model:{value:t.myStyles.strokeOpacity,callback:function(e){t.$set(t.myStyles,"strokeOpacity",e)},expression:"myStyles.strokeOpacity"}}),i("div",{staticClass:"percent-sign"},[t._v("%")])],1)])])]),i("div",{staticClass:"setting-button"},[i("el-button",{on:{click:t.hide}},[t._v("返回")]),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("应用")])],1)])},A=[],N={props:{styles:Object},data:function(){return{left:"-280px",myStyles:{},range:""}},methods:{show:function(){this.left="0px"},hide:function(){this.left="-280px"},confirm:function(){var t=JSON.parse(JSON.stringify(this.myStyles));t.fillOpacity=t.fillOpacity/100,t.strokeOpacity=t.strokeOpacity/100,this.$emit("confirm",t)}},watch:{styles:{handler:function(t){t&&(this.myStyles=JSON.parse(JSON.stringify(t)),this.myStyles.fillOpacity=100*this.myStyles.fillOpacity,this.myStyles.strokeOpacity=100*this.myStyles.strokeOpacity)},immediate:!0}}},J=N,B=(i("9ad7"),Object(F["a"])(J,L,A,!1,null,"d7976386",null)),z=B.exports,R=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{visible:t.visible,title:"修改区域样式","append-to-body":"","custom-class":"edit-color-dialog"},on:{"update:visible":function(e){t.visible=e}}},[t.styles?i("div",{staticClass:"dialog-content"},[i("el-radio-group",{model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[i("el-radio-button",{attrs:{label:"fill"}},[t._v("区域填充")]),i("el-radio-button",{attrs:{label:"stroke"}},[t._v("区域轮廓")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"fill"===t.value,expression:"value === 'fill'"}],staticClass:"item"},[i("el-form",{attrs:{"label-width":"90px","label-position":"left"}},[i("el-form-item",{attrs:{label:"自定义颜色"}},[i("el-input",{staticStyle:{width:"130px"},model:{value:t.myStyles.fillColor,callback:function(e){t.$set(t.myStyles,"fillColor",e)},expression:"myStyles.fillColor"}}),i("el-color-picker",{staticStyle:{"vertical-align":"middle"},model:{value:t.myStyles.fillColor,callback:function(e){t.$set(t.myStyles,"fillColor",e)},expression:"myStyles.fillColor"}})],1),i("el-form-item",{attrs:{label:"透明度"}},[i("div",{staticClass:"set-opacity"},[i("el-input-number",{staticStyle:{width:"130px"},attrs:{"controls-position":"right",min:0,max:100},model:{value:t.myStyles.fillOpacity,callback:function(e){t.$set(t.myStyles,"fillOpacity",e)},expression:"myStyles.fillOpacity"}})],1)])],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"stroke"===t.value,expression:"value === 'stroke'"}],staticClass:"item"},[i("el-form",{attrs:{"label-width":"90px","label-position":"left"}},[i("el-form-item",{attrs:{label:"自定义颜色"}},[i("el-input",{staticStyle:{width:"130px"},attrs:{placeholder:""},model:{value:t.myStyles.strokeColor,callback:function(e){t.$set(t.myStyles,"strokeColor",e)},expression:"myStyles.strokeColor"}}),i("el-color-picker",{staticStyle:{"vertical-align":"middle"},model:{value:t.myStyles.strokeColor,callback:function(e){t.$set(t.myStyles,"strokeColor",e)},expression:"myStyles.strokeColor"}})],1),i("el-form-item",{attrs:{label:"透明度"}},[i("div",{staticClass:"set-opacity"},[i("el-input-number",{staticStyle:{width:"130px"},attrs:{"controls-position":"right",min:0,max:100},model:{value:t.myStyles.strokeOpacity,callback:function(e){t.$set(t.myStyles,"strokeOpacity",e)},expression:"myStyles.strokeOpacity"}})],1)]),i("el-form-item",{attrs:{label:"轮廓宽度"}},[i("el-input-number",{staticStyle:{width:"130px"},attrs:{"controls-position":"right",min:1,max:5},model:{value:t.myStyles.strokeWeight,callback:function(e){t.$set(t.myStyles,"strokeWeight",e)},expression:"myStyles.strokeWeight"}})],1)],1)],1),i("div",{staticClass:"colors"},t._l(t.colors,function(e,o){return i("span",{key:o,staticClass:"color-item",class:{active:t.isActive(e)},style:{"background-color":e},on:{click:function(i){return t.handleClick(e)}}})}),0),i("div",{staticClass:"preview"},[i("div",{staticClass:"view",style:t.previewStyle})])],1):t._e(),i("div",{staticClass:"dialog-footer"},[i("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确定")])],1)])},H=[],Y={props:{styles:Object},data:function(){return{visible:!1,myStyles:{},value:"fill",colors:["#D0021B","#F421AB","#F57470","#F7C01C","#F8E71C","#FBF585","#7ED321","#50E3C2","#0BB78B","#0BB78C","#13F8FF","#0078FF","#9013FE","#B045DF","#E594F3"]}},computed:{color:function(){return"fill"===this.value?this.myStyles.fillColor:this.myStyles.strokeColor},previewStyle:function(){return{"border-style":"solid","border-color":_(this.myStyles.strokeColor,this.myStyles.strokeOpacity/100),"border-width":this.myStyles.strokeWeight+"px","background-color":_(this.myStyles.fillColor,this.myStyles.fillOpacity/100)}}},methods:{open:function(){this.visible=!0},handleClick:function(t){"fill"===this.value?this.myStyles.fillColor=t:this.myStyles.strokeColor=t},confirm:function(){var t=JSON.parse(JSON.stringify(this.myStyles));t.fillOpacity=t.fillOpacity/100,t.strokeOpacity=t.strokeOpacity/100,this.visible=!1,this.$emit("confirm",t)},isActive:function(t){return"fill"===this.value?this.myStyles.fillColor.toLowerCase()===t.toLowerCase():this.myStyles.strokeColor.toLowerCase()===t.toLowerCase()}},watch:{styles:{handler:function(t){t&&(this.myStyles=JSON.parse(JSON.stringify(t)),this.myStyles.fillOpacity=100*this.myStyles.fillOpacity,this.myStyles.strokeOpacity=100*this.myStyles.strokeOpacity)},immediate:!0}}},V=Y,Z=(i("303b"),Object(F["a"])(V,R,H,!1,null,null,null)),q=Z.exports;function K(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,o)}return i}function Q(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?K(i,!0).forEach(function(e){Object(r["a"])(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):K(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var U="OPENLAYERS_POLYGONS",X={components:{InfoWindow:G,StyleSetting:z,EditStyleDialog:q},data:function(){return{GDMap:null,source:null,vector:null,modify:null,draw:null,snap:null,drawPointCount:0,isDrawing:!1,showMapTooltip:!1,mapTooltipText:"单击进行绘制",checkList:[],polygons:[],editPolygons:[],mapLoading:!0,dataLoading:!0,mapTools:[{name:"polygon",functionName:"AddArea",label:"添加区域",icon:"icon-regional"}],editStyleDialog:{styles:null,polygonId:""},styles:{polygon:{fillColor:"#409EFF",fillOpacity:.2,strokeColor:"#409EFF",strokeWeight:1,strokeOpacity:.9}},infoWindow:{overlay:null,extData:{},polygonIndex:null,visible:!1,isEditAttribute:!1,position:null}}},created:function(){this._getMapAreaList()},mounted:function(){var t=this;this.source=new b["a"],this.editSource=new b["a"],this.vector=new S["a"]({source:this.source}),this.GDMap=new c["a"]({target:"GDMap",controls:Object(y["a"])({zoom:!1}),layers:[new k["a"]({source:new C["a"]({url:"http://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&x={x}&y={y}&z={z}"})}),this.vector],view:new d["a"]({projection:"EPSG:4326",center:[116.403847,39.915526],zoom:11,minZoom:3,maxZoom:18})}),setTimeout(function(){t.GDMap.updateSize()},20),this.modify=new g["a"]({source:this.editSource,style:new x["c"]({image:new O["a"]({radius:3,fill:new D["a"]({color:this.styles.polygon.fillColor})})})}),this.snap=new v["a"]({source:this.source,pixelTolerance:5}),this.mapLoading=!1,this.initEvent()},computed:{loading:function(){return this.mapLoading||this.dataLoading},infoWindowTools:function(){var t=[];return t=this.infoWindow.isEditAttribute?[{name:"complate",label:"完成",icon:"el-icon-check"}]:[{name:"editStyle",functionName:"EditAreaStyle",label:"编辑样式",icon:"icon-color"},{name:"editNode",functionName:"EditAreaNode",label:"开启/结束编辑节点",icon:"el-icon-menu"},{name:"editAttribute",functionName:"EditAreaAttributes",label:"编辑属性",icon:"el-icon-edit"},{name:"delete",functionName:"DelArea",label:"删除",icon:"el-icon-delete"}],t}},methods:{initEvent:function(){var t=this;this.mapClickEvent=this.GDMap.on("click",function(e){t.isDrawing&&t.drawPointCount++,t.GDMap.forEachFeatureAtPixel(e.pixel,function(t){t.dispatchEvent({type:"click",event:e})})}),this.mapPointermoveEvent=this.GDMap.on("pointermove",function(e){if(t.isDrawing&&(t.showMapTooltip=!0,t.$refs.mapTooltip)){var i=e.pixel;t.setMapTooltipPosition(i)}})},handleSetStyle:function(){this.checkList.length?this.$refs.styleSetting.show():this.$message.error("请勾选需要批量修改样式的区域")},styleSettingConfirm:function(t){var e=this,i=this.source.getFeatures(),o=this.polygons;i.forEach(function(i){var o=i.getId();e.checkList.indexOf(o)>-1&&e.polygonSetStyle(i,t)}),o.forEach(function(i){e.checkList.indexOf(i.id)>-1&&(i.styles=t)}),$["a"].set(U,this.polygons),this.$refs.styleSetting.hide()},handleToolClick:function(t){switch(t.name){case"polygon":this.handleDrawPolygon(t);break}},infoWindowToolClick:function(t){var e=t.name,i=this.infoWindow.featureIndex,o=this.source.getFeatures()[i];if(!(i<=-1))switch(e){case"editStyle":this.handleEditStyle();break;case"editNode":this.handleEditNode(o);break;case"editAttribute":this.infoWindow.isEditAttribute=!0;break;case"delete":this.handleDelete(o);break;case"complate":this.handleComplate(o);break}},handleEditStyle:function(){this.$refs.editStyleDialog.open()},handleEditNode:function(t){var e=this.polygons[this.infoWindow.polygonIndex].styles,i=t.getProperties().edit;if(t.setProperties({edit:!i}),i){var o=t.getGeometry().getCoordinates()[0];o=o.map(function(t){return{lng:t[0],lat:t[1]}});var s={id:t.getId(),path:o};console.log(s),this.polygonSetStyle(t,e),this.editSource.removeFeature(t),this.GDMap.removeInteraction(this.modify),this.GDMap.removeInteraction(this.snap),this.polygons[this.infoWindow.polygonIndex].path=o,$["a"].set(U,this.polygons)}else this.editSource.addFeature(t),this.polygonSetStyle(t,e,"edit"),this.GDMap.addInteraction(this.modify),this.GDMap.addInteraction(this.snap)},handleDelete:function(t){var e=t.getId();console.log(e),this.polygons.splice(this.infoWindow.polygonIndex,1),$["a"].set(U,this.polygons),this.vector.getSource().removeFeature(t),this.infoWindow.visible=!1},handleComplate:function(t){var e=this.infoWindow.extData,i=e.title,o=e.desc,s=this.infoWindow.polygonIndex,n={id:t.getId(),title:i,desc:o};console.log(n),this.polygons[s].title=i,this.polygons[s].desc=o,$["a"].set(U,this.polygons),t.setProperties({extData:this.polygons[s]}),this.infoWindow.isEditAttribute=!1},infoWindowClose:function(){this.infoWindow.isEditAttribute?this.infoWindow.isEditAttribute=!1:this.infoWindow.visible=!1},editStyleConfirm:function(t){var e=this.source.getFeatures(),i=this.infoWindow.polygonIndex;if(i>-1){var o=e[this.infoWindow.featureIndex],s=o.getProperties().edit,n={id:o.getId(),styles:t};console.log(n),this.polygons[i].styles=t,$["a"].set(U,this.polygons),this.polygonSetStyle(o,t,s?"edit":"add")}},addPolygon:function(t){var e=this,i=t.path.map(function(t){return[t.lng,t.lat]}),o=new f["a"]({geometry:new h["a"]([i])});this.polygonSetStyle(o,t.styles),o.setProperties({extData:t}),o.setId(t.id),this.vector.getSource().addFeature(o),o.on("click",function(t){var i=t.target,o=t.event.coordinate;e.isDrawing||e.setInfoWindowPosition(i,o)})},handleDrawPolygon:function(t){if(this.isDrawing)this.GDMap.removeInteraction(this.draw),this.GDMap.removeInteraction(this.snap),this.draw.un("drawend",this.drawCompleted),this.isDrawing=!1,this.showMapTooltip=!1;else{this.isDrawing=!0;var e=this.styles.polygon;this.draw=new w["a"]({type:"Polygon",style:new x["c"]({fill:new D["a"]({color:this.hexToRgba(e.fillColor,e.fillOpacity)}),stroke:new W["a"]({color:e.fillColor,width:1}),image:new O["a"]({radius:3,fill:new D["a"]({color:e.fillColor})})})}),this.GDMap.addInteraction(this.draw),this.GDMap.addInteraction(this.snap),this.draw.on("drawend",this.drawCompleted)}t.label=this.isDrawing?"取消操作":"添加区域"},drawCompleted:function(t){var e=this;this.drawPointCount=0;var i=t.feature,o=i.getGeometry().getCoordinates()[0];o=o.map(function(t){return{lng:t[0],lat:t[1]}});var s={id:P(),type:"polygon",title:"区域".concat(this.polygons.length+1),desc:"",path:o,styles:Q({},this.styles.polygon)};console.log(s),this.polygons.push(s),$["a"].set(U,this.polygons),this.addPolygon(s),i.setProperties({extData:s}),this.setInfoWindowPosition(i),setTimeout(function(){e.GDMap.removeInteraction(e.draw),e.GDMap.removeInteraction(e.snap),e.isDrawing=!1,e.showMapTooltip=!1},20)},handleListItemClick:function(t){var e=t.id,i=this.source.getFeatures(),o=i.findIndex(function(t){return t.getId()===e}),s=i[o];if(s){var n=this.getFeatureCenter(s),l=this.GDMap.getView();this.setInfoWindowPosition(s),l.animate({center:n,duration:500})}},handleCheckAllChange:function(t){this.checkList=t?this.polygons.map(function(t){return t.id}):[]},setInfoWindowPosition:function(t,e){var i=this,o=this.getFeatureCenter(t),s=t.getProperties().extData;this.infoWindow.visible=!0,this.infoWindow.extData=s,this.infoWindow.polygonIndex=this.polygons.findIndex(function(t){return t.id===s.id}),this.infoWindow.featureIndex=this.source.getFeatures().findIndex(function(t){return t.getId()===s.id}),this.editStyleDialog.styles=s.styles,this.editStyleDialog.polygonId=s.id,this.$nextTick(function(){var t=i.$refs.infoWindow.$el.clientHeight,s=i.GDMap.getPixelFromCoordinate(e||o);s[1]=s[1]-t/2-10;var n=i.GDMap.getCoordinateFromPixel(s);i.infoWindow.overlay||(i.infoWindow.overlay=new p["a"]({element:i.$refs.infoWindow.$el}),i.GDMap.addOverlay(i.infoWindow.overlay)),i.infoWindow.overlay.setPosition(n)})},setMapTooltipPosition:function(t){var e=t[0]+12,i=t[1]-12;this.$refs.mapTooltip.style.left=e+"px",this.$refs.mapTooltip.style.top=i+"px"},getFeatureCenter:function(t){var e=t.getGeometry(),i=e.getCoordinates()[0],o=Object(u["x"])(Object(u["b"])(i));return o},polygonSetStyle:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"add",o=new D["a"]({color:this.hexToRgba(e.fillColor,e.fillOpacity)}),s=new W["a"]({color:this.hexToRgba(e.strokeColor,e.strokeOpacity),width:e.strokeWeight}),n=new x["c"]({fill:o,stroke:s}),l=new x["c"]({image:new O["a"]({radius:3,fill:new D["a"]({color:this.styles.polygon.fillColor})}),geometry:function(){var e=t.getGeometry().getCoordinates()[0];return new m["a"](e)}});"add"===i?t.setStyle(n):t.setStyle([n,l])},hexToRgba:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return _(t,e)},_getMapAreaList:function(){var t=this;setTimeout(function(){t.polygons=$["a"].get(U,[]),t.polygons.forEach(function(e){t.addPolygon(e)}),t.dataLoading=!1},500)}},watch:{drawPointCount:function(t){this.mapTooltipText=t>=2?"双击完成绘制":"单击进行绘制"}}},tt=X,et=(i("257d"),Object(F["a"])(tt,l,a,!1,null,"36f722e8",null)),it=et.exports,ot={name:"app",components:{HelloWorld:it}},st=ot,nt=(i("5c0b"),Object(F["a"])(st,s,n,!1,null,null,null)),lt=nt.exports,at=(i("6861"),i("5c96")),rt=i.n(at);i("0fae");o["default"].use(rt.a,{size:"small"}),o["default"].config.productionTip=!1,new o["default"]({render:function(t){return t(lt)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var o=i("5e27"),s=i.n(o);s.a},"5e27":function(t,e,i){},6861:function(t,e,i){},"689d":function(t,e,i){"use strict";var o=i("a1f7"),s=i.n(o);s.a},9300:function(t,e,i){},"9ad7":function(t,e,i){"use strict";var o=i("9300"),s=i.n(o);s.a},a1f7:function(t,e,i){},c02c:function(t,e,i){},e42e:function(t,e,i){}});
//# sourceMappingURL=app.d616c2f0.js.map